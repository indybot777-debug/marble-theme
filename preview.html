<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MARBLE</title>
  <link rel="stylesheet" href="assets/marble-base.css">
</head>
<body>

  <!-- Desktop: Centered Logo (inverts on scroll) -->
  <div class="header-logo">
    <a href="/" class="header-logo__link">MARBLE</a>
  </div>
  
  <!-- Desktop: Floating Left Nav -->
  <nav class="header-nav-float">
    <a href="/collections/all" class="header-nav-float__link">shop</a>
    <a href="/pages/archive" class="header-nav-float__link">archive</a>
    <a href="/pages/world" class="header-nav-float__link">world</a>
    <a href="/pages/info" class="header-nav-float__link">info</a>
  </nav>
  
  <!-- Desktop: Cart -->
  <a href="/cart" class="header-cart">cart (0)</a>
  
  <!-- Mobile: Bottom Nav -->
  <header class="header">
    <nav class="header__nav">
      <a href="/collections/all" class="header__nav-link">shop</a>
      <a href="/pages/archive" class="header__nav-link">archive</a>
      <a href="/pages/world" class="header__nav-link">world</a>
      <a href="/pages/info" class="header__nav-link">info</a>
    </nav>
    <a href="/cart" class="header__cart">cart (0)</a>
  </header>

  <!-- Product Grid -->
  <main class="product-grid">
    
    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble1/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Creature Tee - Black</h3>
          <p class="product-card__price">$48.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble2/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Creature Tee - Olive</h3>
          <p class="product-card__price">$48.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble3/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Cat Logo Hoodie</h3>
          <p class="product-card__price">$95.00</p>
        </div>
      </a>
    </article>

    <article class="product-card product-card--sold-out">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble4/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">BONES Rug</h3>
          <p class="product-card__price">$120.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble5/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Logo Tee - Wine</h3>
          <p class="product-card__price">$48.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble6/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Monster Tee - Charcoal</h3>
          <p class="product-card__price">$48.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble7/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Creature Tee - Pink</h3>
          <p class="product-card__price">$48.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble8/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Cat Logo Tee - Black</h3>
          <p class="product-card__price">$48.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble9/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Socks - Striped</h3>
          <p class="product-card__price">$18.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble10/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Keychain - Cat</h3>
          <p class="product-card__price">$12.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble11/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Sticker Pack</h3>
          <p class="product-card__price">$8.00</p>
        </div>
      </a>
    </article>

    <article class="product-card">
      <a href="/products/sample" class="product-card__link">
        <img src="https://picsum.photos/seed/marble12/500/500" class="product-card__image" alt="">
        <div class="product-card__info">
          <h3 class="product-card__title">Tote Bag</h3>
          <p class="product-card__price">$28.00</p>
        </div>
      </a>
    </article>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="newsletter">
      <input type="email" class="newsletter__input" placeholder="email for updates">
    </div>
    
    <nav class="footer__links">
      <a href="/pages/shipping" class="footer__link">shipping</a>
      <a href="/pages/returns" class="footer__link">returns</a>
      <a href="/pages/contact" class="footer__link">contact</a>
      <a href="https://instagram.com/marblesoda" class="footer__link">instagram</a>
    </nav>
    
    <p class="footer__copy">© 2026 marble</p>
  </footer>

  <!-- 3D Cursor-Tracking Eyes -->
  <div class="eyes-container" id="eyesContainer">
    <div class="eyes">
      <div class="eye" style="--blink-delay: 0s;">
        <div class="eye__pupil" id="pupilLeft"></div>
      </div>
      <div class="eye" style="--blink-delay: 0.1s;">
        <div class="eye__pupil" id="pupilRight"></div>
      </div>
    </div>
  </div>

  <!-- Desktop Quick View Modal -->
  <div class="quick-view-overlay" id="quickViewOverlay">
    <div class="quick-view">
      <div class="quick-view__image-wrap">
        <img src="https://picsum.photos/seed/quickview/400/400" class="quick-view__image" id="quickViewImage" alt="">
      </div>
      <div class="quick-view__content">
        <button class="quick-view__close" id="quickViewClose">×</button>
        <h2 class="quick-view__title" id="quickViewTitle">Product Name</h2>
        <p class="quick-view__price" id="quickViewPrice">$00.00</p>
        
        <div class="quick-view__sizes">
          <button class="quick-view__size">xs</button>
          <button class="quick-view__size">s</button>
          <button class="quick-view__size selected">m</button>
          <button class="quick-view__size">l</button>
          <button class="quick-view__size">xl</button>
          <button class="quick-view__size" disabled>xxl</button>
        </div>
        
        <div class="quick-view__actions">
          <button class="quick-view__add" id="quickViewAdd">add to cart</button>
          <a href="#" class="quick-view__details" id="quickViewDetails">view full details</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating glass elements -->
  <button class="back-to-top visible" onclick="window.scrollTo({top:0,behavior:'smooth'})">↑ top</button>
  
  <!-- Toast (hidden by default) -->
  <div class="toast" id="toast">added to cart</div>

  <!-- Mobile Quick-Add Drawer -->
  <div class="quick-add-overlay" id="quickAddOverlay"></div>
  <div class="quick-add-drawer" id="quickAddDrawer">
    <div class="quick-add__header">
      <img src="https://picsum.photos/seed/quickadd/200/200" class="quick-add__image" id="quickAddImage" alt="">
      <div class="quick-add__info">
        <h3 class="quick-add__title" id="quickAddTitle">Creature Tee - Black</h3>
        <p class="quick-add__price" id="quickAddPrice">$48.00</p>
      </div>
      <button class="quick-add__close" id="quickAddClose">×</button>
    </div>
    
    <div class="quick-add__sizes">
      <button class="quick-add__size">xs</button>
      <button class="quick-add__size">s</button>
      <button class="quick-add__size selected">m</button>
      <button class="quick-add__size">l</button>
      <button class="quick-add__size">xl</button>
      <button class="quick-add__size" disabled>xxl</button>
    </div>
    
    <button class="quick-add__submit" id="quickAddSubmit">add to cart</button>
  </div>

  <script>
    // ========================================
    // Glitch Text → Katakana Effect
    // ========================================
    // Proper Japanese transliterations (like a Yokohama local would write)
    const wordMap = {
      // Nav
      'shop': 'ショップ',
      'archive': 'アーカイブ',
      'world': 'ワールド',
      'info': 'インフォ',
      'cart': 'カート',
      
      // Product words
      'creature': 'クリーチャー',
      'cat': 'キャット',
      'logo': 'ロゴ',
      'hoodie': 'フーディー',
      'tee': 'ティー',
      't-shirt': 'Tシャツ',
      'bones': 'ボーンズ',
      'rug': 'ラグ',
      'monster': 'モンスター',
      'socks': 'ソックス',
      'striped': 'ストライプ',
      'keychain': 'キーチェーン',
      'sticker': 'ステッカー',
      'pack': 'パック',
      'tote': 'トート',
      'bag': 'バッグ',
      
      // Colors
      'black': 'ブラック',
      'olive': 'オリーブ',
      'wine': 'ワイン',
      'charcoal': 'チャコール',
      'pink': 'ピンク',
      'white': 'ホワイト',
      'grey': 'グレー',
      'gray': 'グレー',
      'red': 'レッド',
      'blue': 'ブルー',
      'green': 'グリーン',
      'navy': 'ネイビー',
      'cream': 'クリーム',
      'brown': 'ブラウン',
      
      // Common words
      'sold': '完売',
      'new': 'ニュー',
      'limited': '限定',
      'edition': 'エディション',
      'collection': 'コレクション',
      'vintage': 'ヴィンテージ',
      'classic': 'クラシック',
      'original': 'オリジナル',
      
      // Footer links
      'shipping': '配送',
      'returns': '返品',
      'contact': 'お問い合わせ',
      'instagram': 'インスタグラム',
      'twitter': 'ツイッター',
      'email': 'メール',
      'about': '私たちについて',
      'faq': 'よくある質問',
      'terms': '利用規約',
      'privacy': 'プライバシー'
    };
    
    const glitchChars = 'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲンー';
    
    function toKatakana(text) {
      let result = text.toLowerCase();
      
      // Replace whole words first (longer words first to avoid partial matches)
      const sortedWords = Object.keys(wordMap).sort((a, b) => b.length - a.length);
      for (const word of sortedWords) {
        const regex = new RegExp(word, 'gi');
        result = result.replace(regex, wordMap[word]);
      }
      
      // Keep punctuation and symbols
      result = result.replace(/ - /g, ' ー ');
      result = result.replace(/\[sold\]/gi, '【完売】');
      
      return result;
    }
    
    function scrambleText(element, originalText, targetText, duration = 600) {
      const length = Math.max(originalText.length, targetText.length);
      const steps = 8;
      const stepTime = duration / steps;
      let currentStep = 0;
      
      element.classList.add('glitching');
      
      const interval = setInterval(() => {
        currentStep++;
        let result = '';
        
        for (let i = 0; i < length; i++) {
          const progress = currentStep / steps;
          const charResolved = i < targetText.length * progress;
          
          if (charResolved) {
            result += targetText[i] || '';
          } else if (i < originalText.length) {
            // Random glitch character
            result += glitchChars[Math.floor(Math.random() * glitchChars.length)];
          }
        }
        
        element.textContent = result;
        
        if (currentStep >= steps) {
          clearInterval(interval);
          element.textContent = targetText;
          element.classList.remove('glitching');
        }
      }, stepTime);
      
      return interval;
    }
    
    // Apply glitch effect to links (English default, katakana on hover)
    function applyGlitchToLinks(selector) {
      document.querySelectorAll(selector).forEach(link => {
        const englishText = link.textContent;
        const katakanaText = toKatakana(englishText);
        let currentInterval = null;
        
        link.dataset.english = englishText;
        link.dataset.katakana = katakanaText;
        
        link.addEventListener('mouseenter', () => {
          if (currentInterval) clearInterval(currentInterval);
          currentInterval = scrambleText(link, link.textContent, katakanaText, 400);
        });
        
        link.addEventListener('mouseleave', () => {
          if (currentInterval) clearInterval(currentInterval);
          currentInterval = scrambleText(link, link.textContent, englishText, 400);
        });
      });
    }
    
    // Nav links
    applyGlitchToLinks('.header-nav-float__link');
    
    // Footer links
    applyGlitchToLinks('.footer__link');

    // Apply to product titles (katakana by default, English on hover)
    document.querySelectorAll('.product-card__title').forEach(title => {
      const englishText = title.textContent;
      const katakanaText = toKatakana(englishText);
      let currentInterval = null;
      
      title.dataset.english = englishText;
      title.dataset.katakana = katakanaText;
      
      // Start with katakana
      title.textContent = katakanaText;
      
      title.closest('.product-card').addEventListener('mouseenter', () => {
        if (currentInterval) clearInterval(currentInterval);
        currentInterval = scrambleText(title, title.textContent, englishText);
      });
      
      title.closest('.product-card').addEventListener('mouseleave', () => {
        if (currentInterval) clearInterval(currentInterval);
        currentInterval = scrambleText(title, title.textContent, katakanaText);
      });
    });

    // ========================================
    // Cursor-Tracking Eyes
    // ========================================
    const pupilLeft = document.getElementById('pupilLeft');
    const pupilRight = document.getElementById('pupilRight');
    const eyesContainer = document.getElementById('eyesContainer');
    
    document.addEventListener('mousemove', (e) => {
      if (window.innerWidth <= 700) return;
      
      const eyes = document.querySelectorAll('.eye');
      eyes.forEach((eye, i) => {
        const rect = eye.getBoundingClientRect();
        const eyeCenterX = rect.left + rect.width / 2;
        const eyeCenterY = rect.top + rect.height / 2;
        
        // Calculate angle to cursor
        const angle = Math.atan2(e.clientY - eyeCenterY, e.clientX - eyeCenterX);
        
        // Calculate distance (capped)
        const distance = Math.min(
          Math.hypot(e.clientX - eyeCenterX, e.clientY - eyeCenterY) / 15,
          10
        );
        
        // Move pupil
        const pupil = eye.querySelector('.eye__pupil');
        const x = Math.cos(angle) * distance;
        const y = Math.sin(angle) * distance;
        
        pupil.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px))`;
      });
    });

    // ========================================
    // Back to Top
    // ========================================
    const backToTop = document.querySelector('.back-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });
    
    // ========================================
    // Mobile Quick-Add Drawer
    // ========================================
    const mobileOverlay = document.getElementById('quickAddOverlay');
    const drawer = document.getElementById('quickAddDrawer');
    const drawerCloseBtn = document.getElementById('quickAddClose');
    const drawerSubmitBtn = document.getElementById('quickAddSubmit');
    const toast = document.getElementById('toast');
    
    function openDrawer(title, price) {
      document.getElementById('quickAddTitle').textContent = title;
      document.getElementById('quickAddPrice').textContent = price;
      mobileOverlay.classList.add('open');
      drawer.classList.add('open');
    }
    
    function closeDrawer() {
      mobileOverlay.classList.remove('open');
      drawer.classList.remove('open');
    }
    
    mobileOverlay.addEventListener('click', closeDrawer);
    drawerCloseBtn.addEventListener('click', closeDrawer);
    
    // Size selection (drawer)
    document.querySelectorAll('.quick-add__size').forEach(btn => {
      btn.addEventListener('click', () => {
        if (btn.disabled) return;
        document.querySelectorAll('.quick-add__size').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
      });
    });
    
    drawerSubmitBtn.addEventListener('click', () => {
      closeDrawer();
      setTimeout(() => {
        toast.classList.add('visible');
        setTimeout(() => toast.classList.remove('visible'), 2000);
      }, 300);
    });

    // ========================================
    // Desktop Quick View Modal
    // ========================================
    const desktopOverlay = document.getElementById('quickViewOverlay');
    const quickViewClose = document.getElementById('quickViewClose');
    const quickViewAdd = document.getElementById('quickViewAdd');
    
    function openQuickView(title, price) {
      document.getElementById('quickViewTitle').textContent = title;
      document.getElementById('quickViewPrice').textContent = price;
      desktopOverlay.classList.add('open');
    }
    
    function closeQuickView() {
      desktopOverlay.classList.remove('open');
    }
    
    desktopOverlay.addEventListener('click', (e) => {
      if (e.target === desktopOverlay) closeQuickView();
    });
    quickViewClose.addEventListener('click', closeQuickView);
    
    // Size selection (quick view)
    document.querySelectorAll('.quick-view__size').forEach(btn => {
      btn.addEventListener('click', () => {
        if (btn.disabled) return;
        document.querySelectorAll('.quick-view__size').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
      });
    });
    
    quickViewAdd.addEventListener('click', () => {
      closeQuickView();
      setTimeout(() => {
        toast.classList.add('visible');
        setTimeout(() => toast.classList.remove('visible'), 2000);
      }, 200);
    });
    
    // Escape to close
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeQuickView();
        closeDrawer();
      }
    });

    // ========================================
    // Product Card Click Handler
    // ========================================
    document.querySelectorAll('.product-card').forEach(card => {
      card.addEventListener('click', (e) => {
        e.preventDefault();
        const title = card.querySelector('.product-card__title')?.textContent || 'Product';
        const price = card.querySelector('.product-card__price')?.textContent || '$0.00';
        
        if (window.innerWidth <= 700) {
          openDrawer(title, price);
        } else {
          openQuickView(title, price);
        }
      });
    });
  </script>

</body>
</html>
